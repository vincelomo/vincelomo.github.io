<html>
<head>
	<title>QR Code scanner</title>
	<style type="text/css">
	html,body {
		width: 100%;
		height: 100%;
		margin: 0;
		padding: 0;
	}
	#camera-preview {
		width: 100%;
		height: 100%;
		background: black;
		color: white;
	}
	</style>
</head>
<body>
	<div id="camera-preview">
		Please grant access to camera <br>
		<video id="video" height="300" width="400" autoplay>Video is not supported by your browser</video>
		<div class="buttonHolder">
		    <a href="#" class="button" id="pictureButton">Cheese!</a>
		</div>
		<canvas height="300" width="400"></canvas>
	</div>
	<script type="text/javascript" src="/javascripts/adapter.js"></script>
	<script type="text/javascript">
	(function(){
		var videoSrcId = "";
		navigator.mediaDevices.enumerateDevices()
		.then(function(devices) {
		  devices.forEach(function(device) {
		    console.log(device.kind + ": " + device.label +
		                " id = " + device.deviceId);
		    if(device.kind == "videoinput"){
		    	videoSrcId = device.deviceId;
		    	break;
		    }
		  });
		})

		var p = navigator.mediaDevices.getUserMedia({ audio: false, video: { sourceId: videoSrcId } });

		p.then(function(stream) {
		   var video = document.querySelector('video');
		   video.src = window.URL.createObjectURL(stream);
		   video.onloadedmetadata = function(e) {
		      // Do something with the video here.
		      video.play();
		   };
		});

		p.catch(function(e) { alert(e.name); }); // always check for errors at the end.
	})();
	</script>
</body>
</html>